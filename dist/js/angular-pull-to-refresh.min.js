!function(){"use strict";angular.module("nx.widget",[])}(),function(){"use strict";angular.module("nx.widget").constant("nxPullToRefreshConfig",{treshold:60,debounce:400,text:{pull:"下拉刷新",release:"释放更新",loading:"加载数据",complete:"加载完成"}})}(),function(){"use strict";angular.module("nx.widget").directive("nxPullToRefresh",function(e,t,n,l){return{scope:!0,restrict:"A",transclude:!0,template:'<div class="nx-widget-pull-to-refresh-indecator"><span ng-bind="text[status]"></span></div><div ng-transclude></div>',compile:function(e,o,s){return function(e,o,s){var a,i,r,u,c,d,f=angular.extend({},l,s),g=angular.element(document.body),p=o.parent(),h=o.children()[0],b=h.nextElementSibling,m=!1,x=!1;e.text=f.text,e.status="pull",o.addClass("nx-widget-pull-to-refresh-wrapper"),angular.element(b).addClass("nx-widget-pull-to-refresh-scroller");var v=function(t){e.$apply(function(){e.status=t,m="release"===t})},y=function(e,t){b.style.WebkitTransform="translate3d(0,"+e+"px,0)",b.style.WebkitTransition="all "+t+"s"};p.bind("touchstart",function(e){a=e.touches[0].pageY,u=Date.now(),v("pull")}),g.bind("touchmove",function(e){console.log("move...."),x=b.getBoundingClientRect().top>=0,x=x&&d<e.touches[0].pageY,x&&(e.preventDefault(),i=e.touches[0].pageY-a,c=Date.now()-u,r=i/3,console.log(r),y(r,0),h.style.WebkitTransform="translate3d(0,"+(r/2-20)+"px,0)",i>100&&c>400&&i-r>60&&v("release")),d=e.touches[0].pageY}),g.bind("touchend",function(l){m?(m=!1,v("loading"),h.style.WebkitTransform="translate3d(0,0,0)",h.style.WebkitTransition="all 0.3s",y(40,.3),n.when(e.$eval(s.nxPullToRefresh)).then(function(){t(function(){e.status="complete",y(0,.3),h.style.WebkitTransform="",h.style.WebkitTransition=""},1e3)})):(y(0,.3),h.style.WebkitTransform="",h.style.WebkitTransition="")}),e.$on("$destroy",function(){p.unbind("touchstart"),g.unbind("touchmove"),g.unbind("touchend")})}}}})}();