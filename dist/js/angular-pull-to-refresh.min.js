!function(){"use strict";angular.module("nx.widget",[])}(),function(){"use strict";angular.module("nx.widget").constant("nxPullToRefreshConfig",{treshold:60,debounce:400,text:{pull:"下拉刷新",release:"释放更新",loading:"加载数据",complete:"加载完成"}})}(),function(){"use strict";angular.module("nx.widget").directive("nxPullToRefresh",function(t,e,n,l){return{scope:!0,restrict:"A",transclude:!0,template:'<div class="nx-widget-pull-to-refresh-indecator"><span ng-bind="text[status]"></span></div><div ng-transclude></div>',compile:function(t,o,i){return function(t,o,i){var s,a,u,r,c,d,g=angular.extend({},l,i),f=angular.element(document.body),p=o.parent(),h=o.children()[0],b=h.nextElementSibling,m=!1,x=!1;o[0].getBoundingClientRect().top;t.text=g.text,t.status="pull",o.addClass("nx-widget-pull-to-refresh-wrapper"),angular.element(b).addClass("nx-widget-pull-to-refresh-scroller");var y=function(e){t.$apply(function(){t.status=e,m="release"===e})},T=function(t,e){b.style.WebkitTransform="translate3d(0,"+t+"px,0)",b.style.WebkitTransition="all "+e+"s"};p.bind("touchstart",function(t){s=t.touches[0].pageY,r=Date.now(),y("pull")}),f.bind("touchmove",function(t){x=b.getBoundingClientRect().top>=0,x=x&&d<t.touches[0].pageY,x&&(t.preventDefault(),a=t.touches[0].pageY-s+b.getBoundingClientRect().top,c=Date.now()-r,u=a/4,T(u,0),h.style.WebkitTransform="translate3d(0,"+(u/2-20)+"px,0)",a>100&&c>400&&a-u>60&&y("release")),d=t.touches[0].pageY}),f.bind("touchend",function(l){console.log(m),m?(m=!1,y("loading"),h.style.WebkitTransform="translate3d(0,0,0)",h.style.WebkitTransition="all 0.3s",T(40,.3),n.when(t.$eval(i.nxPullToRefresh)).then(function(){e(function(){t.status="complete",T(0,.3),h.style.WebkitTransform="",h.style.WebkitTransition=""},1e3)})):(T(0,.3),h.style.WebkitTransform="",h.style.WebkitTransition="")}),t.$on("$destroy",function(){p.unbind("touchstart"),f.unbind("touchmove"),f.unbind("touchend")})}}}})}();