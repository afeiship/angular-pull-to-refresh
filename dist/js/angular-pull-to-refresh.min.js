!function(){"use strict";angular.module("nx.widget",[])}(),function(){"use strict";angular.module("nx.widget").constant("nxPullToRefreshConfig",{treshold:60,debounce:400,text:{pull:"下拉刷新",release:"释放更新",loading:"加载数据",complete:"加载完成"}})}(),function(){"use strict";angular.module("nx.widget").directive("nxPullToRefresh",function(t,e,n,l){return{scope:!0,restrict:"A",transclude:!0,template:'<div class="nx-widget-pull-to-refresh-indecator"><span ng-bind="text[status]"></span></div><div ng-transclude></div>',compile:function(t,s,o){return function(t,s,o){var a,i,r,u,c,d=angular.extend({},l,o),f=angular.element(document.body),p=s.parent(),g=s.children()[0],b=g.nextElementSibling,h=!1;t.text=d.text,t.status="pull",s.addClass("nx-widget-pull-to-refresh-wrapper"),angular.element(b).addClass("nx-widget-pull-to-refresh-scroller");var m=function(e){t.$apply(function(){t.status=e,h="release"===e})},x=function(t,e){b.style.WebkitTransform="translate3d(0,"+t+"px,0)",b.style.WebkitTransition="all "+e+"s"};p.bind("touchstart",function(t){a=t.touches[0].pageY,u=Date.now(),m("pull")}),f.bind("touchmove",function(t){t.preventDefault(),i=t.touches[0].pageY-a,c=Date.now()-u,r=i/3,x(r,0),g.style.WebkitTransform="translate3d(0,"+(r/2-20)+"px,0)",i>100&&c>400&&i-r>60&&m("release")}),f.bind("touchend",function(l){console.log(h),h?(h=!1,m("loading"),g.style.WebkitTransform="translate3d(0,0,0)",g.style.WebkitTransition="all 0.3s",x(40,.3),n.when(t.$eval(o.nxPullToRefresh)).then(function(){e(function(){t.status="complete",x(0,.3),g.style.WebkitTransform="",g.style.WebkitTransition=""},1e3)})):(x(0,.3),g.style.WebkitTransform="",g.style.WebkitTransition="")}),t.$on("$destroy",function(){p.unbind("touchstart"),f.unbind("touchmove"),f.unbind("touchend")})}}}})}();