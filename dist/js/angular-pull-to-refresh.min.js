!function(){"use strict";angular.module("nx.widget",[])}(),function(){"use strict";angular.module("nx.widget").constant("nxPullToRefreshConfig",{treshold:60,debounce:400,text:{pull:"下拉刷新",release:"释放更新",loading:"加载数据",complete:"加载完成"}})}(),function(){"use strict";angular.module("nx.widget").directive("nxPullToRefresh",function(e,t,n,l){return{scope:!0,restrict:"A",transclude:!0,template:'<div class="nx-widget-pull-to-refresh-indecator"><span ng-bind="text[status]"></span></div><div ng-transclude></div>',compile:function(e,s,o){return function(e,s,o){var a,i,r,u,c,d,f=angular.extend({},l,o),p=angular.element(document.body),g=s.parent(),h=s.children()[0],b=h.nextElementSibling,m=!1,x=!1;e.text=f.text,e.status="pull",s.addClass("nx-widget-pull-to-refresh-wrapper"),angular.element(b).addClass("nx-widget-pull-to-refresh-scroller");var y=function(t){e.$apply(function(){e.status=t,m="release"===t})},T=function(e,t){b.style.WebkitTransform="translate3d(0,"+e+"px,0)",b.style.WebkitTransition="all "+t+"s"};g.bind("touchstart",function(e){a=e.touches[0].pageY,u=Date.now(),y("pull")}),p.bind("touchmove",function(e){x=d<e.touches[0].pageY,x&&(e.preventDefault(),i=e.touches[0].pageY-a,c=Date.now()-u,r=i/3,T(r,0),h.style.WebkitTransform="translate3d(0,"+(r/2-20)+"px,0)",i>100&&c>400&&i-r>60&&y("release")),d=e.touches[0].pageY}),p.bind("touchend",function(l){console.log(m),m?(m=!1,y("loading"),h.style.WebkitTransform="translate3d(0,0,0)",h.style.WebkitTransition="all 0.3s",T(40,.3),n.when(e.$eval(o.nxPullToRefresh)).then(function(){t(function(){e.status="complete",T(0,.3),h.style.WebkitTransform="",h.style.WebkitTransition=""},1e3)})):(T(0,.3),h.style.WebkitTransform="",h.style.WebkitTransition="")}),e.$on("$destroy",function(){g.unbind("touchstart"),p.unbind("touchmove"),p.unbind("touchend")})}}}})}();